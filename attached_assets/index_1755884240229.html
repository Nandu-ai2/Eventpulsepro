<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EventPulse - Discover Amazing Events</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />

  <style>
    :root {
      --primary: #6366F1;
      --secondary: #8B5CF6;
      --success: #10B981;
      --warning: #F59E0B;
      --danger: #EF4444;
    }
    body {
      font-family: 'Inter', sans-serif;
      background-color: #F9FAFB;
      color: #111827;
      min-height: 100vh;
      margin: 0;
      padding: 0;
    }
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .hero-gradient {
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    }
    .card-hover {
      transition: all 0.2s ease-in-out;
    }
    .card-hover:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
    }
    .sticky-nav {
      position: sticky;
      top: 0;
      z-index: 50;
      backdrop-filter: blur(8px);
      background: rgba(255, 255, 255, 0.95);
    }
    .modal-backdrop {
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(4px);
    }
    .modal-animate {
      animation: slideIn 0.3s ease-out;
    }
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .rsvp-option {
      transition: all 0.2s ease;
      cursor: pointer;
    }
    .rsvp-option:hover {
      background-color: #F9FAFB;
      border-color: var(--primary);
    }
    .rsvp-option:has(input:checked) {
      border-color: var(--primary);
      background-color: #EEF2FF;
    }

    @media (max-width: 768px) {
      .hero-search-grid {
        grid-template-columns: 1fr !important;
      }
      .event-grid {
        grid-template-columns: 1fr !important;
      }
      .filter-sidebar {
        width: 100% !important;
        position: static !important;
      }
    }

    .loading-spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid var(--primary);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .alert {
      padding: 12px 16px;
      border-radius: 8px;
      margin-bottom: 16px;
      display: none;
    }

    .alert.success {
      background-color: #D1FAE5;
      border: 1px solid #10B981;
      color: #065F46;
    }

    .alert.error {
      background-color: #FEE2E2;
      border: 1px solid #EF4444;
      color: #991B1B;
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Navigation -->
  <nav class="sticky-nav bg-white shadow-sm border-b border-gray-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center space-x-8">
          <div class="flex items-center">
            <i class="fas fa-calendar-check text-indigo-600 text-2xl mr-2"></i>
            <span class="text-xl font-bold text-gray-900">EventPulse</span>
          </div>
          <div class="hidden md:flex space-x-6">
            <a href="#" onclick="showEventsSection()" class="text-gray-700 hover:text-indigo-600 transition-colors duration-200 font-medium">Discover</a>
            <a href="#" onclick="showMyEventsSection()" class="text-gray-700 hover:text-indigo-600 transition-colors duration-200 font-medium">My Events</a>
            <a href="#" onclick="showCreateEventSection()" class="text-gray-700 hover:text-indigo-600 transition-colors duration-200 font-medium">Create Event</a>
          </div>
        </div>
        <div class="flex items-center space-x-4">
          <div class="relative">
            <input type="search" placeholder="Search events..." 
                   class="w-64 pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-600 focus:border-transparent"
                   id="searchInput" />
            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
          </div>
          <div class="relative">
            <button class="flex items-center space-x-2 bg-gray-100 rounded-full p-2 hover:bg-gray-200 transition-colors duration-200" onclick="toggleUserMenu()">
              <div class="w-8 h-8 bg-indigo-500 rounded-full flex items-center justify-center">
                <span class="text-white text-sm font-semibold" id="userInitials">U</span>
              </div>
              <span class="hidden sm:block text-sm font-medium text-gray-700" id="userName">User</span>
            </button>
            <div id="userMenu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200">
              <div class="py-2">
                <button onclick="showLoginModal()" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Login / Register</button>
                <button onclick="logout()" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" id="logoutBtn" style="display: none;">Logout</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero-gradient py-16 text-white" id="heroSection">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-10">
        <h1 class="text-4xl md:text-6xl font-bold mb-4">Discover Amazing Events</h1>
        <p class="text-xl text-purple-100 max-w-2xl mx-auto">Find and join events that match your interests. Connect with like-minded people in your city.</p>
      </div>
      <div class="max-w-4xl mx-auto">
        <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6">
          <div class="grid grid-cols-1 md:grid-cols-4 gap-4 hero-search-grid">
            <div class="md:col-span-2">
              <input type="text" placeholder="What are you interested in?" 
                     class="w-full px-4 py-3 rounded-lg text-gray-900 focus:ring-2 focus:ring-white focus:outline-none border-0"
                     id="interestInput" />
            </div>
            <div>
              <select class="w-full px-4 py-3 rounded-lg text-gray-900 focus:ring-2 focus:ring-white focus:outline-none border-0" id="locationSelect">
                <option value="all">All Cities</option>
                <option value="san francisco">San Francisco, CA</option>
                <option value="new york">New York, NY</option>
                <option value="los angeles">Los Angeles, CA</option>
                <option value="chicago">Chicago, IL</option>
              </select>
            </div>
            <button class="bg-white text-indigo-600 font-semibold py-3 px-6 rounded-lg hover:bg-gray-100 transition-colors duration-200" onclick="searchEvents()">
              <i class="fas fa-search mr-2"></i>Find Events
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Event Categories -->
  <section class="py-8 bg-white border-b border-gray-200" id="categoriesSection">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex flex-wrap justify-center gap-4" id="categoryButtons">
        <button class="px-4 py-2 bg-indigo-600 text-white rounded-full text-sm font-medium hover:bg-indigo-700 transition-colors duration-200" data-category="all">All Events</button>
        <button class="px-4 py-2 bg-gray-100 text-gray-700 rounded-full text-sm font-medium hover:bg-gray-200 transition-colors duration-200" data-category="technology">Technology</button>
        <button class="px-4 py-2 bg-gray-100 text-gray-700 rounded-full text-sm font-medium hover:bg-gray-200 transition-colors duration-200" data-category="business">Business</button>
        <button class="px-4 py-2 bg-gray-100 text-gray-700 rounded-full text-sm font-medium hover:bg-gray-200 transition-colors duration-200" data-category="health">Health</button>
        <button class="px-4 py-2 bg-gray-100 text-gray-700 rounded-full text-sm font-medium hover:bg-gray-200 transition-colors duration-200" data-category="sports">Sports</button>
        <button class="px-4 py-2 bg-gray-100 text-gray-700 rounded-full text-sm font-medium hover:bg-gray-200 transition-colors duration-200" data-category="arts">Arts</button>
        <button class="px-4 py-2 bg-gray-100 text-gray-700 rounded-full text-sm font-medium hover:bg-gray-200 transition-colors duration-200" data-category="music">Music</button>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8" id="mainContent">
    <!-- Events Section -->
    <div id="eventsSection">
      <div class="flex flex-col lg:flex-row gap-8">
        <!-- Sidebar Filters -->
        <aside class="lg:w-1/4 filter-sidebar">
          <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 sticky top-24">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">Filters</h3>
            <!-- Date Filter -->
            <div class="mb-6">
              <h4 class="text-sm font-medium text-gray-700 mb-3">Date</h4>
              <div class="space-y-2">
                <label class="flex items-center">
                  <input type="radio" name="date" value="any" checked class="text-indigo-600 focus:ring-indigo-600" onchange="filterEvents()" />
                  <span class="ml-2 text-sm text-gray-600">Any date</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="date" value="week" class="text-indigo-600 focus:ring-indigo-600" onchange="filterEvents()" />
                  <span class="ml-2 text-sm text-gray-600">This week</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="date" value="weekend" class="text-indigo-600 focus:ring-indigo-600" onchange="filterEvents()" />
                  <span class="ml-2 text-sm text-gray-600">This weekend</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="date" value="next-week" class="text-indigo-600 focus:ring-indigo-600" onchange="filterEvents()" />
                  <span class="ml-2 text-sm text-gray-600">Next week</span>
                </label>
              </div>
            </div>

            <!-- Price Filter -->
            <div class="mb-6">
              <h4 class="text-sm font-medium text-gray-700 mb-3">Price</h4>
              <div class="space-y-2">
                <label class="flex items-center">
                  <input type="checkbox" checked class="text-indigo-600 focus:ring-indigo-600" id="freeFilter" onchange="filterEvents()" />
                  <span class="ml-2 text-sm text-gray-600">Free</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" checked class="text-indigo-600 focus:ring-indigo-600" id="paidFilter" onchange="filterEvents()" />
                  <span class="ml-2 text-sm text-gray-600">Paid</span>
                </label>
              </div>
            </div>

            <!-- Distance Filter -->
            <div>
              <h4 class="text-sm font-medium text-gray-700 mb-3">Distance</h4>
              <select class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-600 focus:border-transparent" onchange="filterEvents()" id="distanceSelect">
                <option value="any">Any distance</option>
                <option value="5">Within 5 miles</option>
                <option value="10">Within 10 miles</option>
                <option value="25">Within 25 miles</option>
              </select>
            </div>
          </div>
        </aside>

        <!-- Events Grid -->
        <div class="lg:w-3/4">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-gray-900" id="eventsTitle">Upcoming Events</h2>
            <div class="flex items-center space-x-2">
              <span class="text-sm text-gray-600">Sort by:</span>
              <select class="border border-gray-300 rounded-lg px-3 py-1 text-sm focus:ring-2 focus:ring-indigo-600 focus:border-transparent" onchange="sortEvents(this.value)" id="sortSelect">
                <option value="date">Date</option>
                <option value="popular">Popular</option>
                <option value="distance">Distance</option>
                <option value="price">Price</option>
              </select>
            </div>
          </div>

          <div id="loadingSpinner" class="loading-spinner" style="display: none;"></div>
          <div id="alertContainer"></div>

          <div id="eventsContainer" class="grid grid-cols-1 md:grid-cols-2 gap-6 event-grid">
            <!-- Events loaded here -->
          </div>

          <div class="text-center mt-8" id="loadMoreContainer">
            <button class="bg-white text-indigo-600 border-2 border-indigo-600 px-8 py-3 rounded-lg font-medium hover:bg-indigo-600 hover:text-white transition-colors duration-200" onclick="loadMoreEvents()">Load More Events</button>
          </div>

          <div id="noEventsMessage" class="text-center py-12 hidden">
            <div class="text-gray-400 text-6xl mb-4">
              <i class="fas fa-calendar-times"></i>
            </div>
            <h3 class="text-xl font-semibold text-gray-900 mb-2">No events found</h3>
            <p class="text-gray-600">Try adjusting your filters or search terms</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Create Event Section -->
    <div id="createEventSection" class="hidden">
      <div class="max-w-2xl mx-auto">
        <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">Create New Event</h2>
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-8">
          <form id="createEventForm">
            <div class="mb-6">
              <label for="eventTitle" class="block text-sm font-medium text-gray-700 mb-2">Event Title</label>
              <input type="text" id="eventTitle" name="title" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-600 focus:border-transparent" placeholder="Enter event title">
            </div>
            <div class="mb-6">
              <label for="eventDescription" class="block text-sm font-medium text-gray-700 mb-2">Description</label>
              <textarea id="eventDescription" name="description" rows="4" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-600 focus:border-transparent" placeholder="Describe your event"></textarea>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
              <div>
                <label for="eventDate" class="block text-sm font-medium text-gray-700 mb-2">Date</label>
                <input type="date" id="eventDate" name="date" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-600 focus:border-transparent">
              </div>
              <div>
                <label for="eventTime" class="block text-sm font-medium text-gray-700 mb-2">Time</label>
                <input type="time" id="eventTime" name="time" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-600 focus:border-transparent">
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
              <div>
                <label for="eventCity" class="block text-sm font-medium text-gray-700 mb-2">City</label>
                <input type="text" id="eventCity" name="city" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-600 focus:border-transparent" placeholder="Event city">
              </div>
              <div>
                <label for="eventCategory" class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                <select id="eventCategory" name="category" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-600 focus:border-transparent">
                  <option value="">Select category</option>
                  <option value="technology">Technology</option>
                  <option value="business">Business</option>
                  <option value="health">Health</option>
                  <option value="sports">Sports</option>
                  <option value="arts">Arts</option>
                  <option value="music">Music</option>
                </select>
              </div>
            </div>
            <div class="mb-6">
              <label for="eventPrice" class="block text-sm font-medium text-gray-700 mb-2">Price (optional)</label>
              <input type="number" id="eventPrice" name="price" min="0" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-600 focus:border-transparent" placeholder="0.00">
              <p class="text-sm text-gray-500 mt-1">Leave empty for free events</p>
            </div>
            <div class="flex justify-end space-x-4">
              <button type="button" onclick="showEventsSection()" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200">Cancel</button>
              <button type="submit" class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200">Create Event</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- My Events Section -->
    <div id="myEventsSection" class="hidden">
      <h2 class="text-3xl font-bold text-gray-900 mb-8">My Events</h2>
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <div id="myEventsContainer">
          <p class="text-gray-500 text-center py-8">Please login to view your events</p>
        </div>
      </div>
    </div>
  </main>

  <!-- Login/Register Modal -->
  <div id="loginModal" class="fixed inset-0 modal-backdrop flex items-center justify-center z-50 hidden">
    <div class="modal-animate bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl">
      <div class="text-center mb-6">
        <h2 class="text-2xl font-bold text-gray-900" id="loginModalTitle">Welcome to EventPulse</h2>
        <p class="text-gray-600 mt-2">Join to create and manage events</p>
      </div>
      
      <div class="flex border border-gray-300 rounded-lg mb-6">
        <button id="loginTab" class="flex-1 py-2 px-4 text-center bg-indigo-600 text-white rounded-l-lg transition-colors duration-200" onclick="switchTab('login')">Login</button>
        <button id="registerTab" class="flex-1 py-2 px-4 text-center bg-gray-100 text-gray-600 rounded-r-lg transition-colors duration-200" onclick="switchTab('register')">Register</button>
      </div>

      <form id="authForm">
        <div id="registerFields" class="hidden">
          <div class="mb-4">
            <input type="text" id="registerName" name="name" placeholder="Full Name" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-600 focus:border-transparent" />
          </div>
        </div>
        <div class="mb-4">
          <input type="email" id="authEmail" name="email" placeholder="Email Address" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-600 focus:border-transparent" />
        </div>
        <div class="mb-6">
          <input type="password" id="authPassword" name="password" placeholder="Password" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-600 focus:border-transparent" />
        </div>
        <button type="submit" class="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition-colors duration-200" id="authSubmitBtn">Login</button>
      </form>

      <div class="flex justify-center mt-6">
        <button onclick="closeLoginModal()" class="text-gray-500 hover:text-gray-700 transition-colors duration-200">
          <i class="fas fa-times text-xl"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- RSVP Modal -->
  <div id="rsvpModal" class="fixed inset-0 modal-backdrop flex items-center justify-center z-50 hidden">
    <div class="modal-animate bg-white rounded-2xl p-8 max-w-lg w-full mx-4 shadow-2xl">
      <div class="text-center mb-6">
        <div class="inline-flex items-center justify-center w-16 h-16 bg-indigo-100 rounded-full mb-4">
          <i class="fas fa-calendar-check text-2xl text-indigo-600"></i>
        </div>
        <h2 class="text-2xl font-bold text-gray-900" id="rsvpEventTitle">Event Title</h2>
        <div class="text-gray-600 mt-2">
          <div class="flex items-center justify-center space-x-4 text-sm">
            <span class="flex items-center">
              <i class="fas fa-calendar mr-1"></i>
              <span id="rsvpEventDate">Date</span>
            </span>
            <span class="flex items-center">
              <i class="fas fa-map-marker-alt mr-1"></i>
              <span id="rsvpEventCity">City</span>
            </span>
          </div>
        </div>
      </div>
      
      <div class="space-y-3 mb-8">
        <div class="rsvp-option border-2 border-gray-200 rounded-xl p-4" onclick="selectRSVP('Yes')">
          <label class="flex items-center cursor-pointer">
            <input type="radio" name="rsvp" value="Yes" class="text-green-600 focus:ring-green-600 mr-3" />
            <div>
              <div class="font-semibold text-green-600">Yes, I'll attend</div>
              <div class="text-sm text-gray-500">I'll be there!</div>
            </div>
          </label>
        </div>
        
        <div class="rsvp-option border-2 border-gray-200 rounded-xl p-4" onclick="selectRSVP('Maybe')">
          <label class="flex items-center cursor-pointer">
            <input type="radio" name="rsvp" value="Maybe" class="text-yellow-600 focus:ring-yellow-600 mr-3" />
            <div>
              <div class="font-semibold text-yellow-600">Maybe</div>
              <div class="text-sm text-gray-500">I might join if I'm free</div>
            </div>
          </label>
        </div>
        
        <div class="rsvp-option border-2 border-gray-200 rounded-xl p-4" onclick="selectRSVP('No')">
          <label class="flex items-center cursor-pointer">
            <input type="radio" name="rsvp" value="No" class="text-red-600 focus:ring-red-600 mr-3" />
            <div>
              <div class="font-semibold text-red-600">Can't make it</div>
              <div class="text-sm text-gray-500">Unfortunately, I can't attend</div>
            </div>
          </label>
        </div>
      </div>
      
      <div class="flex space-x-4">
        <button onclick="closeRSVPModal()" class="flex-1 bg-gray-100 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-200 transition-colors duration-200">Cancel</button>
        <button onclick="submitRSVP()" class="flex-1 bg-indigo-600 text-white py-3 rounded-xl font-semibold hover:bg-indigo-700 transition-colors duration-200">Submit RSVP</button>
      </div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='public/script.js') }}"></script>
</body>
</html>
